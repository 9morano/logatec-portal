<p>The testbed can be operated remotely through the LOG-a-TEC web portal. The user can select a cluster of VESNAs and configure them to perform sensing and/or transmission. As a result, the testbed is able to support sensing only experiments, transmission only experiments (excluding TV bands) and also transmission based on sensing results. The LOG-a-TEC web portal uses the GRASS-RaPlaT tool in order to (i) to provide the virtual experiment planning via simulation in order to ascertain the best setup before the actual execution in the testbed as well as (ii) to support the postprocessing and visualization of experimentation results.</p>
<img src="img/Logatec-clusters.png">
</p>

<h3 class="anchor" id="sw_comp">Log-a-tec software components</h3>
<p>The Log-a-tec testbed consists of several software components as described in the following sections.</p>
<h4>LOG-a-TEC testbed access, control and reconfiguration</h4>
<h5>Establishing a connection from nodes to the server</h5>
<p>This section focuses on user access to the VESNA-based testbed and the technologies behind it. The wireless sensor network among nodes is based on ZigBee, as implemented in the ZigBit port to Atmel modules. It is a multihop network, which means the gateway is able to communicate also with the nodes out of its direct wireless range.</p>
<p>For the purpose of communication between sensor network and the server located at JSI (infrastructure side) we developed a new protocol (see figure below), which was inspired by the HTTP protocol and is simple enough for fast implementation on VESNA nodes. The protocol defines two types of requests, GET and POST, which are understood by every VESNA node. The GET is used for &ldquo;safe&rdquo; requests which do not change the state of the system and POST for &ldquo;unsafe&rdquo; requests which change the state of the system. The response from a node following a GET request is considered to be in binary format and handled accordingly, although general responses are in text format and only the spectrum sensing data is in binary format. Every response ends with the sequence OK\r\n to indicate the end of the response.</p>
<p><img alt="" src="img/Resource_access_protocol.png" /></p>
<p>The protocol includes simple and efficient error handling mechanism. There are two types of errors defined. The first is JUNK-INPUT, which is the more common situation when the resource name is mistyped and the parser on the node does not recognize it. After this response the parser on the node expects five new lines, which resets the parser. Only after that the resource can be accessed again. The second type of error is CORRUPTED-DATA, used when cyclic redundancy check (CRC) check did not succeed thus we can conclude that the error happened somewhere on the line between the infrastructure and the gateway. The last situation will occur with very low probability.</p>
<p>The protocol is designed as a client-server protocol. In our case the servers are sensor nodes and the client is the server on the infrastructure side. Before we can access the resources the gateway has to establish a connection with the infrastructure side. This is done by establishing a secure SSL encrypted socket with the server. The gateway has an Ethernet module embedded on the expansion board which is used to connect the gateway to the internet. The Ethernet module is configured to get the IP address from DHCP server and then automatically tries to set up an encrypted SSL socket with one of the SSL servers listening on a specific port located on the infrastructure side. Once the connection has been established one could access any resource (sensor, radio module, etc.) or procedure on any of the nodes. Procedures pre-prepared on the nodes include Remote reprogramming, start spectrum sensing, collect spectrum data, configure nodes as transmitters, configure frequency band, etc. Below a simplified schematic of the VESNA-based testbed is provided.</p>
<p><img alt="" src="img/Logatec-schematic.png" style="width: 593px; height: 157px; " /></p>
<h5 class="anchor" id="access_web">Testbed access through the web portal</h5>
<p>The web app, shown in the figure below, is split in two parts. &nbsp;The right hand side of the graphical user interface (GUI) includes Google maps where one can observe locations of the nodes and based on the color code distinct between their role in the network (e.g. gateway, ISM band sensing node, TV band sensing node). The left hand side of GUI is used for the interaction between the user and the testbed. Features in this part of the web app include:</p>
		<ul>
			<li>Choosing one of the three available clusters: one at JSI location and two in Logatec, one in the industrial zone and the other in the city center. Each cluster needs its own SSL server listening on the infrastructure side and by changing the cluster we make a switch to a different SSL server.</li>
			<li>Experiment description: The experiment can be described in a simple text file in which we specify the GET and POST requests which form our experiment. The commands are separated by an empty line.</li>
			<li>Logging support: All the requests and responses are stored in the request-response log file, where the spectrum sensing data is also collected in the format that corresponds to the CREW common data format.</li>
			<li>GET and POST request fields: The web app also provides an option to send single manually configured GET or POST request to the sensor network.</li>
			<li>Remote reprogramming support: For reprogramming the nodes there is an option to select a binary file from a user&rsquo;s local environment and upload it to the server where a special script, written to send the file to the gateway, cuts the file into packets of 512 bytes. Each packet gets a header of 4 bytes containing the serial number of the packet and the footer of 4 bytes with the CRC of the packet. The finished packet is 520 bytes long and gets transferred to the gateway which forwards the packet to the selected end node. The ZigBee packets were extended by an additional layer which can handle packets of this size. The packets are stored on an SD card of the node which is divided into several slots; each slot is able to store one firmware image. After the transfer is complete the node is set to boot the firmware from the requested SD card slot and then rebooted. After a reboot the new firmware is loaded in the flash and started.</li>
			<li>Reset SSL connection button: The web app GUI features also a safety button to reset the system in case of unexpected events that may be caused by bugs or errors in the communication links.</li>
		</ul>
<p><img alt="" src="img/Logatec_web_portal.png" /></p>
<p>&nbsp;</p>
<h5 class="anchor" id="access_http">Testbed access through the exposed HTTP API</h5>
<p>As indicated above, the alternative way to access the LOG-a-TEC testbed, mainly supported for the advanced users and developers, is by calling the HTTP API. The call to the API has to meet the specified form for GET and POST requests:</p>
		<ul>
			<li>https://crn.log-a-tec.eu/communicator?cluster=&quot;port&quot;&amp;method=get&amp;resource=&quot;resource&quot;</li>
			<li>https://crn.log-a-tec.eu/communicator?cluster=&quot;port&quot;&amp;method=post&amp;resource=&quot;resource&quot;&amp;content=&quot;content&quot;</li>
		</ul>
<p>To make a GET or POST request we have to make a call to handler called &ldquo;communicator&rdquo;, which is located on the web server on the LOG-a-TEC infrastructure with the domain name crn.log&shy;-a-tec.eu. The call is made over secure HTTPS encrypted socket requiring authentication and has to include the following parameters:</p>
		<ul>
			<li>The cluster: This corresponds to the SSL port which the cluster gateway is connected to. The JSI cluster is connected to the port 9501, the Logatec industrial zone cluster to 10001 and the Logatec city center to 10002.</li>
			<li>The method: The method can be either GET or POST.</li>
			<li>Resource: The last parameter in the case of GET request is the resource. This corresponds to the resource name located on the target node from one of the clusters.</li>
			<li>Content: The POST request includes also content where we specify the reconfiguration parameters for the nodes.</li>
		</ul>
<p>All the requests that do not meet the specified form are rejected.</p>
<p>The portal can be accessed from <a href="http://www.log-a-tec.eu/">www.log-a-tec.eu</a>, where authentication is necessary to be able to enter. For now the authentication parameters can be added only manually for interested experimenters whereas an automated subscription system with scheduler for the experimenters is under development.</p>
<h3 class="anchor" id="raplat">GRASS-RaPlaT for experiment planning and visualization of measurements</h3>
<p>In order to help experimenter in setting parameters of the experiment, the radio propagation tool <a href="http://www-e6.ijs.si/en/software/grass-raplat">GRASS-RaPlaT</a> is included in JSI Outdoor VESNA-based testbed. GRASS-RaPlaT is an open-source radio planning tool developed at Jozef Stefan Institute as an add-on to the open source Geographical Information Systems (GIS) GRASS. GRASS operates over raster and vector data and includes methods for image processing and display. It comprises over 350 modules for processing, analysis and visualization of geographical data. The core modules and libraries are written in the C programming language. For large projects, processing may be automated by using a scripting language such as Phyton. MySQL, PostgreSQL and DBF database engines are currently supported by GRASS and can be used for storing the data table. In addition, GRASS maps and modules may be imported into other GIS software packages, e.g. Q-GIS.</p>
<p>RaPlaT is a set of modules for a number of channel models, a module for sectorization according to given antenna patterns, a module for calculating and storing the complete radio network coverage data, and a number of supporting modules, e.g. for adapting input data and analyzing simulation results. Thus GRASS-RaPlaT is a powerful tool for designing, analyzing and presenting single node or radio network coverage.</p>
<p>The role of the GRASS-RaPlaT in LOG-a-TEC testbed is (i) to provide support in experiment planning via simulation in order to ascertain the best setup before the actual execution in the testbed and (ii) to support the postprocessing and visualization of experimentation results. An experiment is configured via a web interface and the results of the experiment are also accessible via the web interface. A web server requests the required computation by simply issuing a Linux command with corresponding parameters. This command, which is actually a script, establishes the necessary GRASS environment and executes callbacks of GRASS-RaPlaT or other commands.</p>
<p>The web interface allows configuring nodes either as a transmitter or a receiver. If a particular node is not configured as a transmitter or a receiver, it is assumed as a non-active for the experiment. The main variable parameters for a transmitter are its transmission power and frequency. To provide support in experiment planning, the following preset simulations of radio coverage by GRASS-RaPlaT (&ldquo;virtual experiments&rdquo;) are available: (i) transmission radio coverage estimation, (ii) transmission range estimation (interference area) of the nodes, (iii) estimation of the signal level at the specified receiver locations for all active transmitters, (iv) estimation of the coverage area of all active transmitters and (v) hidden node detection simulation. In the experiments aimed at determining the location of the hidden node based on the measurements obtained from the testbed, GRASS-RaPlaT provides support for the post-processing and visualization of experimentation results and thus calculates the hidden node interference area.</p>
<p><img alt="" src="img/Grass-Raplat-UHF_Simulation_0.png" /></p>
